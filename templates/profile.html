{% extends "base.html" %}

{% block content %}
<section class="page-header">
    <h1>RuneScape Profile Lookup</h1>
    <p>Enter your RuneScape username to view your profile data</p>
</section>

<section class="profile-container">
    <div class="profile-search">
        <form method="POST" action="/profile">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" placeholder="Enter RuneScape username" 
                       value="{{ username if username else '' }}" required>
                <button type="submit" class="btn">Search</button>
            </div>
        </form>
    </div>

    {% if error %}
    <div class="error-message">
        <p>{{ error }}</p>
    </div>
    {% endif %}

    {% if profile_data %}
    <div class="profile-data" style="background-color: var(--box-bg);">
        <div class="profile-layout">
            <div class="profile-left-column">
                <div class="profile-header">
                    <div class="profile-header-top">
                        <div class="profile-header-info">
                            <h2>{{ profile_data.name }}</h2>
                            <p>Combat Level: {{ profile_data.combatlevel }}</p>
                            <p>Total Skill: {{ profile_data.totalskill }}</p>
                            <p>Total XP: {{ "{:,}".format(profile_data.totalxp) }}</p>
                            <p>Quests Completed: {{ profile_data.questscomplete }}</p>
                            <p>Quests Started: {{ profile_data.questsstarted }}</p>
                            <p>Quests Not Started: {{ profile_data.questsnotstarted }}</p>
                            <p>Rank: {{ profile_data.rank }}</p>
                        </div>
                    </div>
                </div>

                <div class="profile-section skills-section">
                    <h3>Skills</h3>
                    <div class="skills-grid">
                    <!-- First row -->
                    {% for skill_id in [0, 3, 14] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Second row -->
                    {% for skill_id in [2, 16, 13] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Third row -->
                    {% for skill_id in [1, 15, 10] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Fourth row -->
                    {% for skill_id in [4, 17, 7] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Fifth row -->
                    {% for skill_id in [5, 12, 11] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Sixth row -->
                    {% for skill_id in [6, 9, 8] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Seventh row -->
                    {% for skill_id in [20, 18, 19] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Eighth row -->
                    {% for skill_id in [22, 21, 23] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Ninth row -->
                    {% for skill_id in [24, 25, 26] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    
                    <!-- Tenth row (partial) -->
                    {% for skill_id in [27, 28] %}
                        {% for skill in profile_data.skillvalues %}
                            {% if skill.id == skill_id %}
                            <div class="skill-item" 
                                 onmouseover="showSkillDetails('{{ skill.id|get_skill_name }}', {{ skill.level }}, {{ skill.xp }}, {{ skill.rank }})"
                                 onmouseout="hideSkillDetails()">
                                <div class="skill-icon">
                                    <img src="{{ url_for('static', filename='img/21px-' + (skill.id|get_skill_name) + '-icon.webp') }}" alt="{{ skill.id|get_skill_name }}">
                                </div>
                                <div class="skill-level">{{ skill.level }}</div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                    </div>
                    <div class="skill-details-box" id="skillDetailsBox" style="background-color: var(--box-bg);">
                        <div class="skill-details-content">
                            <h4 id="skillName">Hover over a skill</h4>
                            <p id="skillLevel">Level: -</p>
                            <p id="skillXP">XP: -</p>
                            <p id="skillRank">Rank: -</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="profile-right-column">
                <div class="profile-section">
                    <h3>Recent Activities</h3>
                    <ul class="activities-list">
                        {% for activity in profile_data.activities %}
                        <li class="activity-item">
                            <span class="activity-date">{{ activity.date }}</span>
                            <span class="activity-text">{{ activity.text }}</span>
                            <span class="activity-details">{{ activity.details }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
    </div>
    {% endif %}
</section>
{% endblock %}
